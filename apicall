CREATE TABLE latest_updates (
  customer_id STRING(MAX),
  updated_at TIMESTAMP,
) PRIMARY KEY (customer_id);


INSERT INTO latest_updates (customer_id, updated_at)
SELECT customer_id, MAX(updated_at)
FROM your_table
GROUP BY customer_id;

SELECT t.*
FROM your_table t
JOIN latest_updates u
ON t.customer_id = u.customer_id AND t.updated_at = u.updated_at;

CREATE INDEX idx_customer_latest ON your_table(customer_id, updated_at DESC);
