
public class BigQueryMonitor {

    public static void main(String[] args) {
        BigQuery bigQuery = BigQueryOptions.getDefaultInstance().getService();

        try {
            int runningQueries = countRunningQueries(bigQuery);
            System.out.println("Number of parallel running queries: " + runningQueries);
        } catch (Exception e) {
            e.printStackTrace();
        }
    }

    private static int countRunningQueries(BigQuery bigQuery) {
        int runningQueriesCount = 0;

        // List jobs in the project
        for (Job job : bigQuery.listJobs().iterateAll()) {
            JobStatus status = job.getStatus();
            JobStatistics statistics = job.getStatistics();

            // Check if the job is a query and its state is RUNNING
            if (statistics instanceof QueryStatistics && status.getState() == JobStatus.State.RUNNING) {
                runningQueriesCount++;
            }
        }

        return runningQueriesCount;
    }
}
