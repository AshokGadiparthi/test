timestamp_cols = [
"execution_date", "start_date", "end_date",
"task_start_date", "task_end_date", "extracted_at"
]

for col in timestamp_cols:
if col in df.columns:
# Detect if numeric and looks like epoch
if pd.api.types.is_numeric_dtype(df[col]):
# Assume milliseconds â€” change to 's' if your values have 10 digits instead of 13
df[col] = pd.to_datetime(df[col], unit='ms', errors='coerce', utc=True)
else:
# If already ISO string
df[col] = pd.to_datetime(df[col], errors='coerce', utc=True)
