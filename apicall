Let‚Äôs compute the TRUE difference correctly


Use this exact query:



üîç 1. Rows in OLD but NOT in NEW
SELECT COUNT(*)
FROM `old_dedup` o
LEFT JOIN `new_dedup` n
ON o.cust_id = n.cust_id
AND o.acct_num = n.acct_num
AND o.cust_line_seq_id = n.cust_line_seq_id
AND o.line_eff_dt = n.line_eff_dt
AND o.line_term_dt = n.line_term_dt
AND o.mtn_stat_ind = n.mtn_stat_ind
AND o.min_act_dt = n.min_act_dt
WHERE n.cust_id IS NULL;
üìå This will show the TRUE count of removed rows.

üîç 2. Rows in NEW but NOT in OLD (restored active rows)
SELECT COUNT(*)
FROM `new_dedup` n
LEFT JOIN `old_dedup` o
ON o.cust_id = n.cust_id
AND o.acct_num = n.acct_num
AND o.cust_line_seq_id = n.cust_line_seq_id
AND o.line_eff_dt = n.line_eff_dt
AND o.line_term_dt = n.line_term_dt
AND o.mtn_stat_ind = n.mtn_stat_ind
AND o.min_act_dt = n.min_act_dt
WHERE o.cust_id IS NULL;
üìå These are your ACTIVE records restored by the fix.

üîç 3. Full difference summary
WITH old_count AS (
  SELECT COUNT(*) AS cnt FROM old_dedup
),
new_count AS (
  SELECT COUNT(*) AS cnt FROM new_dedup
),
removed AS (
  SELECT COUNT(*) AS cnt
  FROM old_dedup o
  LEFT JOIN new_dedup n
    ON o.cust_id = n.cust_id
   AND o.acct_num = n.acct_num
   AND o.cust_line_seq_id = n.cust_line_seq_id
   AND o.line_eff_dt = n.line_eff_dt
   AND o.line_term_dt = n.line_term_dt
   AND o.mtn_stat_ind = n.mtn_stat_ind
   AND o.min_act_dt = n.min_act_dt
  WHERE n.cust_id IS NULL
),
added AS (
  SELECT COUNT(*) AS cnt
  FROM new_dedup n
  LEFT JOIN old_dedup o
    ON o.cust_id = n.cust_id
   AND o.acct_num = n.acct_num
   AND o.cust_line_seq_id = n.cust_line_seq_id
   AND o.line_eff_dt = n.line_eff_dt
   AND o.line_term_dt = n.line_term_dt
   AND o.mtn_stat_ind = n.mtn_stat_ind
   AND o.min_act_dt = n.min_act_dt
  WHERE o.cust_id IS NULL
)
SELECT 
  (SELECT cnt FROM old_count) AS old_rows,
  (SELECT cnt FROM new_count) AS new_rows,
  (SELECT cnt FROM removed)  AS removed_rows,
  (SELECT cnt FROM added)    AS restored_rows;
üéØ 
What this will give you


You will get:

Total rows before

Total rows after

Exact removed rows

Exact added/restored rows

Complete accuracy



This will remove confusion around 1190 vs 3576.

If you want


I can generate:



‚úî One single BigQuery SCRIPT that runs all these validations


‚úî A FINAL dashboard output used for sign-off


‚úî A formatted JSON summary for your CDP validation reports


Just tell me ‚ÄúGive me the combined validation script‚Äù.
